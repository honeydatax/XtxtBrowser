' Gambas class file

Public Sub _new()

End

Public Sub Form_Open()

End

Public Sub Button1_Click()
Dim v As String
Dim i As Integer
Dim p As Process
Dim f1 As File
Dim f2 As File
f1 = Open "/home/pi/out" For Output Create
Print #f1, ""
Close #f1
v = TextBox1.Text
i = 0
i = InStr(v, ">")
If i < 1 Then i = InStr(v, "<")
If i > 0 Then
  p = Shell "/bin/sh  -c curl" & v & ""
  Else
  p = Shell "/bin/sh  -c 'curl " & v & "' > /home/pi/out"
Endif
TextArea1.Text = "" 
Timer1.Start()
End Sub

Public Sub Timer1_Timer()
Dim f2 As File
Dim v As String
Dim vv As String
Dim i As Integer
Timer1.Stop()
f2 = Open "/home/pi/out" For Input
While Not Eof(f2)
  Line Input #f2, v
  vv = vv & v
Wend
Close f2
  i = InStr(vv, "<body>")
  If i < 1 Then i = InStr(vv, "<BODY>")
  If i > 0 Then 
    i = i + 6
    vv = Mid(vv, i, Len(vv) - i)
  Endif
  i = InStr(vv, "</body>")
  If i < 1 Then i = InStr(vv, "</BODY>")
  If i > 0 Then 
    vv = Mid(vv, 1, i - 1)
  Endif
  vv = Replace(vv, "<B>", Chr(13) & Chr(10))
  vv = Replace(vv, "</B>", Chr(13) & Chr(10))
  vv = Replace(vv, "<b>", Chr(13) & Chr(10))
  vv = Replace(vv, "</b>", Chr(13) & Chr(10))
  vv = Replace(vv, "<ul>", Chr(13) & Chr(10))
  vv = Replace(vv, "<tr>", Chr(13) & Chr(10))
  vv = Replace(vv, "</tr>", Chr(13) & Chr(10))
  vv = Replace(vv, "<TR>", Chr(13) & Chr(10))
  vv = Replace(vv, "<TR>", Chr(13) & Chr(10))
  vv = Replace(vv, "</ul>", Chr(13) & Chr(10))
  vv = Replace(vv, "<UL>", Chr(13) & Chr(10))
  vv = Replace(vv, "</UL>", Chr(13) & Chr(10))
  vv = Replace(vv, "<li>", Chr(13) & Chr(10))
  vv = Replace(vv, "</li>", Chr(13) & Chr(10))
  vv = Replace(vv, "<LI>", Chr(13) & Chr(10))
  vv = Replace(vv, "</LI>", Chr(13) & Chr(10))
  vv = Replace(vv, "<a>", Chr(13) & Chr(10))
  vv = Replace(vv, "<A>", Chr(13) & Chr(10))
  vv = Replace(vv, "</a>", Chr(13) & Chr(10))
  vv = Replace(vv, "</A>", Chr(13) & Chr(10))
  vv = Replace(vv, "</A>", Chr(13) & Chr(10))
  vv = Replace(vv, "<br>", Chr(13) & Chr(10))
  vv = Replace(vv, "<BR>", Chr(13) & Chr(10))
  vv = Replace(vv, "</br>", Chr(13) & Chr(10))
  vv = Replace(vv, "</BR>", Chr(13) & Chr(10))
  vv = Replace(vv, "</p>", Chr(13) & Chr(10))
  vv = Replace(vv, "</P>", Chr(13) & Chr(10))
  vv = Replace(vv, "<p>", Chr(13) & Chr(10))
  vv = Replace(vv, "<P>", Chr(13) & Chr(10))
  vv = Replace(vv, "<a href=", Chr(13) & Chr(10))
  vv = Replace(vv, "<A HREF=", Chr(13) & Chr(10))
  vv = Replace(vv, "<H1>", Chr(13) & Chr(10))
  vv = Replace(vv, "<H2>", Chr(13) & Chr(10))
  vv = Replace(vv, "<H3>", Chr(13) & Chr(10))
  vv = Replace(vv, "<H4>", Chr(13) & Chr(10))
  vv = Replace(vv, "<H5>", Chr(13) & Chr(10))
  vv = Replace(vv, "</H1>", Chr(13) & Chr(10))
  vv = Replace(vv, "</H2>", Chr(13) & Chr(10))
  vv = Replace(vv, "</H3>", Chr(13) & Chr(10))
  vv = Replace(vv, "</H4>", Chr(13) & Chr(10))
  vv = Replace(vv, "</H5>", Chr(13) & Chr(10))
vv = Replace(vv, "<h1>", Chr(13) & Chr(10))
  vv = Replace(vv, "<h2>", Chr(13) & Chr(10))
  vv = Replace(vv, "<h3>", Chr(13) & Chr(10))
  vv = Replace(vv, "<h4>", Chr(13) & Chr(10))
  vv = Replace(vv, "<h5>", Chr(13) & Chr(10))
  vv = Replace(vv, "</h1>", Chr(13) & Chr(10))
  vv = Replace(vv, "</h2>", Chr(13) & Chr(10))
  vv = Replace(vv, "</h3>", Chr(13) & Chr(10))
  vv = Replace(vv, "</h4>", Chr(13) & Chr(10))
  vv = Replace(vv, "</h5>", Chr(13) & Chr(10))
  vv = Replace(vv, "</i>", Chr(13) & Chr(10))
  vv = Replace(vv, "</I>", Chr(13) & Chr(10))
 vv = Replace(vv, "<i>", Chr(13) & Chr(10))
  vv = Replace(vv, "</I>", Chr(13) & Chr(10))
vv = Replace(vv, "<hr>", Chr(13) & Chr(10))
vv = Replace(vv, "</hr>", Chr(13) & Chr(10))
vv = Replace(vv, "</HR>", Chr(13) & Chr(10))
vv = Replace(vv, "<HR>", Chr(13) & Chr(10))
vv = Replace(vv, "<ui>", Chr(13) & Chr(10))
vv = Replace(vv, "</ui>", Chr(13) & Chr(10))
vv = Replace(vv, "<UI>", Chr(13) & Chr(10))
vv = Replace(vv, "</UI>", Chr(13) & Chr(10))
TextArea1.Text = TextArea1.Text & Chr(13) & Chr(10) & vv
Timer1.Stop()
Form.Refresh()
End
